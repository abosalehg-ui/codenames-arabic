<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1a1d29">
    <title>Codenames Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --color-red: #d32f2f;
            --color-red-dark: #b71c1c;
            --color-blue: #1976d2;
            --color-blue-dark: #0d47a1;
            --color-beige: #ddc9a3;
            --color-black: #212121;
            
            --bg-primary: #1a1d29;
            --bg-secondary: #252936;
            --bg-card: #2d3142;
            
            --text-primary: #ffffff;
            --text-secondary: #b0b3c1;
            --text-muted: #6c6f85;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* ============================================ */
        /* SCREENS */
        /* ============================================ */
        .screen {
            display: none;
            min-height: 100vh;
        }

        .screen.active {
            display: flex;
            flex-direction: column;
        }

        /* ============================================ */
        /* HOME SCREEN */
        /* ============================================ */
        .home-screen {
            padding: 20px;
            align-items: center;
            justify-content: center;
        }

        .logo {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .title {
            font-size: 2.5rem;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(135deg, var(--color-blue), var(--color-red));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }

        .subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
            text-align: center;
        }

        .card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            width: 100%;
            max-width: 500px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-align: right;
        }

        input {
            width: 100%;
            padding: 12px;
            background: var(--bg-secondary);
            border: 2px solid transparent;
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 1rem;
            font-family: 'Cairo', sans-serif;
        }

        input:focus {
            outline: none;
            border-color: var(--color-blue);
        }

        .btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 700;
            font-family: 'Cairo', sans-serif;
            cursor: pointer;
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--color-blue), var(--color-blue-dark));
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--color-red), var(--color-red-dark));
            color: white;
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
            border: 2px solid var(--bg-card);
        }

        /* ============================================ */
        /* GAME SCREEN - MOBILE OPTIMIZED */
        /* ============================================ */
        .game-screen {
            display: flex;
            flex-direction: column;
            height: 100vh;
            padding: 0;
        }

        /* Top Navigation */
        .top-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background: var(--bg-card);
            border-bottom: 1px solid var(--bg-secondary);
        }

        .nav-icon {
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px 10px;
        }

        .room-code-badge {
            background: var(--color-blue);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
        }

        /* Teams Section */
        .teams-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            padding: 10px;
            background: var(--bg-primary);
        }

        .team-card {
            background: var(--bg-card);
            border-radius: 10px;
            padding: 12px;
            position: relative;
            border: 2px solid transparent;
        }

        .team-card.red {
            border-color: var(--color-red);
        }

        .team-card.blue {
            border-color: var(--color-blue);
        }

        .team-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .team-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--text-secondary);
        }

        .team-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            position: relative;
        }

        .team-count {
            position: absolute;
            bottom: -5px;
            right: -5px;
            background: var(--color-blue);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: 900;
            border: 2px solid var(--bg-card);
        }

        .team-card.red .team-count {
            background: var(--color-red);
        }

        .team-roles {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .role-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            padding: 6px;
            background: var(--bg-secondary);
            border-radius: 6px;
        }

        .role-icon {
            font-size: 1rem;
        }

        .join-team-btn {
            width: 100%;
            padding: 8px;
            margin-top: 8px;
            background: linear-gradient(135deg, #4caf50, #388e3c);
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.85rem;
            font-family: 'Cairo', sans-serif;
            cursor: pointer;
        }

        /* Game Board */
        .board-section {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .game-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 6px;
            margin-bottom: 15px;
        }

        .word-card {
            aspect-ratio: 2/1;
            background: var(--bg-card);
            border: 2px solid var(--bg-secondary);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: 700;
            cursor: pointer;
            padding: 4px;
            text-align: center;
            transition: all 0.2s;
        }

        .word-card:active {
            transform: scale(0.95);
        }

        .word-card.revealed {
            cursor: not-allowed;
        }

        .word-card.RED {
            background: linear-gradient(135deg, var(--color-red), var(--color-red-dark));
            border-color: var(--color-red);
            color: white;
        }

        .word-card.BLUE {
            background: linear-gradient(135deg, var(--color-blue), var(--color-blue-dark));
            border-color: var(--color-blue);
            color: white;
        }

        .word-card.INNOCENT {
            background: var(--color-beige);
            border-color: var(--color-beige);
            color: var(--color-black);
        }

        .word-card.ASSASSIN {
            background: var(--color-black);
            border-color: var(--color-red);
            color: white;
        }

        /* Spymaster hints */
        .word-card.spy-hint-red:not(.revealed) {
            border-color: var(--color-red);
            border-width: 3px;
        }

        .word-card.spy-hint-blue:not(.revealed) {
            border-color: var(--color-blue);
            border-width: 3px;
        }

        .word-card.spy-hint-beige:not(.revealed) {
            border-color: var(--color-beige);
            border-width: 3px;
        }

        .word-card.spy-hint-black:not(.revealed) {
            border-color: var(--color-red);
            border-width: 3px;
            box-shadow: 0 0 10px rgba(211, 47, 47, 0.5);
        }

        /* Status Message */
        .status-message {
            background: var(--bg-card);
            padding: 15px;
            text-align: center;
            font-weight: 700;
            font-size: 1rem;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .status-message.info {
            background: linear-gradient(135deg, rgba(25, 118, 210, 0.2), transparent);
            border: 2px solid var(--color-blue);
        }

        .status-message.warning {
            background: linear-gradient(135deg, rgba(211, 47, 47, 0.2), transparent);
            border: 2px solid var(--color-red);
        }

        /* Clue Section */
        .clue-section {
            background: var(--bg-card);
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .clue-label {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .clue-display {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--color-blue);
            text-align: center;
            padding: 10px;
            background: var(--bg-secondary);
            border-radius: 8px;
            margin-bottom: 5px;
        }

        .clue-count {
            text-align: center;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Controls */
        .controls-section {
            background: var(--bg-card);
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .control-inputs {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
        }

        .control-inputs input {
            flex: 1;
            padding: 10px;
            font-size: 0.9rem;
        }

        .control-inputs input[type="number"] {
            max-width: 70px;
        }

        /* Bottom Navigation */
        .bottom-nav {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 12px;
            background: var(--bg-card);
            border-top: 1px solid var(--bg-secondary);
        }

        .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 0.75rem;
            font-family: 'Cairo', sans-serif;
            cursor: pointer;
            position: relative;
        }

        .nav-btn-icon {
            font-size: 1.5rem;
        }

        .nav-btn.active {
            color: var(--color-blue);
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--color-red);
            color: white;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(5px);
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 30px;
            max-width: 400px;
            width: 100%;
            text-align: center;
        }

        .modal-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .modal-message {
            font-size: 1rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        /* Waiting Room */
        .waiting-room {
            padding: 20px;
        }

        .room-code-display {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 20px;
        }

        .room-code-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .room-code-value {
            font-size: 2.5rem;
            font-weight: 900;
            letter-spacing: 8px;
            color: var(--color-blue);
        }

        .role-selection {
            background: var(--bg-card);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .role-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .role-btn {
            padding: 20px;
            background: var(--bg-secondary);
            border-radius: 10px;
            border: 3px solid transparent;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }

        .role-btn.red {
            border-color: var(--color-red);
        }

        .role-btn.blue {
            border-color: var(--color-blue);
        }

        .role-btn:active {
            transform: scale(0.95);
        }

        .role-btn-icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }

        .role-btn-text {
            font-weight: 700;
            color: var(--text-primary);
        }

        .players-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .player-item {
            padding: 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hidden {
            display: none !important;
        }

        /* Landscape orientation adjustments */
        @media (orientation: landscape) and (max-height: 500px) {
            .teams-container {
                padding: 5px;
            }
            
            .team-card {
                padding: 8px;
            }
            
            .game-grid {
                gap: 4px;
            }
            
            .word-card {
                font-size: 0.65rem;
            }
        }
    </style>
</head>
<body>

<!-- HOME SCREEN -->
<div id="home-screen" class="screen home-screen active">
    <div style="max-width: 500px; width: 100%;">
        <div class="logo">ğŸ¯</div>
        <h1 class="title">Codenames Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</h1>
        <p class="subtitle">Ù„Ø¹Ø¨Ø© Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø´ÙØ±Ø© Ø§Ù„ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠØ© Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</p>
        
        <div class="card">
            <div class="input-group">
                <label>Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨</label>
                <input type="text" id="username-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ">
            </div>
            <button class="btn btn-primary" id="btn-enter-game">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
        </div>

        <div class="card">
            <h3 style="margin-bottom: 15px; text-align: center;">ÙƒÙŠÙ ØªÙ„Ø¹Ø¨</h3>
            <ol style="text-align: right; line-height: 2; padding-right: 20px;">
                <li>Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø©"</li>
                <li>Ø§Ø®ØªØ± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø© ÙˆØ§Ø¨Ø¯Ø£</li>
                <li>Ø´Ø§Ø±Ùƒ Ø±Ø§Ø¨Ø· Ø§Ù„ØºØ±ÙØ© Ù…Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦Ùƒ</li>
                <li>Ø§Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„Ù„Ø¹Ø¨Ø©!</li>
            </ol>
        </div>

        <button class="btn btn-ghost" onclick="testSound()">ğŸ”Š Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØµÙˆØª</button>
    </div>
</div>

<!-- LOBBY SCREEN -->
<div id="lobby-screen" class="screen home-screen">
    <div style="max-width: 500px; width: 100%;">
        <h2 class="title" style="font-size: 2rem;">Ù…Ø±Ø­Ø¨Ø§Ù‹ <span id="player-name-display"></span>! ğŸ‘‹</h2>
        
        <div class="card">
            <h3 style="margin-bottom: 15px;">Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ© Ø¬Ø¯ÙŠØ¯Ø©</h3>
            <div class="input-group">
                <label>Ø§Ø³Ù… Ù…Ø®ØµØµ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                <input type="text" id="create-room-name" placeholder="Ø§ØªØ±Ùƒ ÙØ§Ø±ØºØ§Ù‹ Ù„Ù„Ø±Ù…Ø² Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ" maxlength="6">
            </div>
            <button class="btn btn-primary" id="btn-create-room">ğŸš€ Ø¥Ù†Ø´Ø§Ø¡ ØºØ±ÙØ©</button>
        </div>

        <div class="card">
            <h3 style="margin-bottom: 15px;">Ø§Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ù„ØºØ±ÙØ©</h3>
            <div class="input-group">
                <label>ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©</label>
                <input type="text" id="join-room-code" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯" maxlength="6">
            </div>
            <button class="btn btn-secondary" id="btn-join-room">â†ª Ø§Ù†Ø¶Ù…Ø§Ù…</button>
        </div>

        <button class="btn btn-ghost" id="btn-back-home">â† Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
    </div>
</div>

<!-- WAITING ROOM -->
<div id="waiting-room" class="screen waiting-room">
    <h2 class="title" style="font-size: 2rem; text-align: center; margin-bottom: 20px;">ØºØ±ÙØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</h2>
    
    <div class="room-code-display">
        <div class="room-code-label">ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©:</div>
        <div class="room-code-value" id="room-code-display">------</div>
    </div>

    <div class="role-selection">
        <h3 style="margin-bottom: 15px; text-align: center;">âš”ï¸ Ø§Ø®ØªØ± ÙØ±ÙŠÙ‚Ùƒ ÙˆØ¯ÙˆØ±Ùƒ</h3>
        <div class="role-grid">
            <div class="role-btn red" data-team="RED" data-role="SPYMASTER">
                <div class="role-btn-icon">ğŸ‘‘</div>
                <div class="role-btn-text">Ù‚Ø§Ø¦Ø¯ Ø£Ø­Ù…Ø±</div>
            </div>
            <div class="role-btn red" data-team="RED" data-role="GUESSER">
                <div class="role-btn-icon">ğŸ¯</div>
                <div class="role-btn-text">Ù…Ø®Ù…Ù† Ø£Ø­Ù…Ø±</div>
            </div>
            <div class="role-btn blue" data-team="BLUE" data-role="SPYMASTER">
                <div class="role-btn-icon">ğŸ‘‘</div>
                <div class="role-btn-text">Ù‚Ø§Ø¦Ø¯ Ø£Ø²Ø±Ù‚</div>
            </div>
            <div class="role-btn blue" data-team="BLUE" data-role="GUESSER">
                <div class="role-btn-icon">ğŸ¯</div>
                <div class="role-btn-text">Ù…Ø®Ù…Ù† Ø£Ø²Ø±Ù‚</div>
            </div>
        </div>
    </div>

    <div class="card">
        <h3 style="margin-bottom: 15px;">ğŸ‘¥ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ† (<span id="players-count">0</span>)</h3>
        <ul id="players-list" class="players-list"></ul>
    </div>

    <button class="btn btn-primary hidden" id="btn-start-game">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨Ø©</button>
    <button class="btn btn-ghost" id="btn-leave-room">Ù…ØºØ§Ø¯Ø±Ø© Ø§Ù„ØºØ±ÙØ©</button>
</div>

<!-- GAME SCREEN -->
<div id="game-screen" class="screen game-screen">
    <!-- Top Navigation -->
    <div class="top-nav">
        <div class="nav-icon" id="menu-btn">â˜°</div>
        <div class="room-code-badge" id="game-room-code">XXXXXX</div>
        <div class="nav-icon" id="info-btn">â„¹ï¸</div>
    </div>

    <!-- Teams Container -->
    <div class="teams-container">
        <!-- Blue Team -->
        <div class="team-card blue">
            <div class="team-header">
                <div class="team-title">OPERATIVES</div>
                <div class="team-avatar">
                    ğŸ”µ
                    <div class="team-count" id="blue-score">8</div>
                </div>
            </div>
            <div class="team-roles">
                <div class="role-item">
                    <span class="role-icon">ğŸ‘‘</span>
                    <span>SPYMASTERS</span>
                </div>
            </div>
            <button class="join-team-btn" data-team="BLUE">JOIN TEAM</button>
        </div>

        <!-- Red Team -->
        <div class="team-card red">
            <div class="team-header">
                <div class="team-title">OPERATIVES</div>
                <div class="team-avatar">
                    ğŸ”´
                    <div class="team-count" id="red-score">9</div>
                </div>
            </div>
            <div class="team-roles">
                <div class="role-item">
                    <span class="role-icon">ğŸ‘‘</span>
                    <span>SPYMASTERS</span>
                </div>
            </div>
            <button class="join-team-btn" data-team="RED">JOIN TEAM</button>
        </div>
    </div>

    <!-- Board Section -->
    <div class="board-section">
        <!-- Status Message -->
        <div class="status-message info" id="status-message">
            BLUE TEAM NEEDS A SPYMASTER
        </div>

        <!-- Clue Section -->
        <div class="clue-section hidden" id="clue-section">
            <div class="clue-label">ğŸ’¡ Ø§Ù„ØªÙ„Ù…ÙŠØ­ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
            <div class="clue-display" id="current-clue">ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙ„Ù…ÙŠØ­...</div>
            <div class="clue-count" id="clue-guesses">Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªØ¨Ù‚ÙŠØ©: <strong>0</strong></div>
        </div>

        <!-- Spymaster Controls -->
        <div class="controls-section hidden" id="spymaster-controls">
            <h4 style="margin-bottom: 10px; color: var(--text-secondary); font-size: 0.9rem;">ğŸ‘‘ Ø¥Ø¹Ø·Ø§Ø¡ ØªÙ„Ù…ÙŠØ­</h4>
            <div class="control-inputs">
                <input type="text" id="clue-input" placeholder="Ø§Ù„ØªÙ„Ù…ÙŠØ­">
                <input type="number" id="count-input" placeholder="Ø§Ù„Ø¹Ø¯Ø¯" min="1" max="9">
            </div>
            <button class="btn btn-primary" id="btn-give-clue">ğŸ’¡ Ø¥Ø¹Ø·Ø§Ø¡ Ø§Ù„ØªÙ„Ù…ÙŠØ­</button>
        </div>

        <!-- Guesser Controls -->
        <div class="controls-section hidden" id="guesser-controls">
            <h4 style="margin-bottom: 10px; color: var(--text-secondary); font-size: 0.9rem;">ğŸ¯ Ø¯ÙˆØ±Ùƒ ÙÙŠ Ø§Ù„ØªØ®Ù…ÙŠÙ†</h4>
            <button class="btn btn-secondary" id="btn-end-turn">â­ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø¯ÙˆØ±</button>
        </div>

        <!-- Game Board -->
        <div class="game-grid" id="game-board">
            <!-- Cards will be generated here -->
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="nav-btn">
            <div class="nav-btn-icon">ğŸ‘¥</div>
            <div>Players</div>
        </button>
        <button class="nav-btn">
            <div class="nav-btn-icon">ğŸ”„</div>
            <div>History</div>
        </button>
        <button class="nav-btn active">
            <div class="nav-btn-icon" style="position: relative;">
                ğŸ“°
                <span class="notification-badge">23</span>
            </div>
            <div>News</div>
        </button>
        <button class="nav-btn">
            <div class="nav-btn-icon">ğŸ“–</div>
            <div>Rules</div>
        </button>
        <button class="nav-btn">
            <div class="nav-btn-icon">âš™ï¸</div>
            <div>Settings</div>
        </button>
    </div>
</div>

<!-- MODAL -->
<div id="modal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-icon" id="modal-icon">â„¹ï¸</div>
        <h3 class="modal-title" id="modal-title">Ø¹Ù†ÙˆØ§Ù†</h3>
        <p class="modal-message" id="modal-message">Ø±Ø³Ø§Ù„Ø©</p>
        <button class="btn btn-primary" id="modal-confirm">Ø­Ø³Ù†Ø§Ù‹</button>
    </div>
</div>

<!-- JAVASCRIPT -->
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script>
const BACKEND_URL = 'https://codenames-arabic-server.onrender.com';
let socket;
let gameState = {
    username: '',
    roomCode: '',
    myTeam: null,
    myRole: null,
    board: [],
    currentTurn: null,
    clue: null,
    guessesLeft: 0
};

// Sound
const playSound = (name) => {
    if (typeof Audio !== 'undefined') {
        try {
            const audio = new Audio(`./assets/sounds/${name}.mp3`);
            audio.volume = 0.5;
            audio.play().catch(e => console.warn('Sound play failed:', e));
        } catch (e) {
            console.error('Sound error:', e);
        }
    }
};

const testSound = () => {
    try {
        const audio = new Audio('./assets/sounds/connected.mp3`);
        audio.volume = 0.5;
        audio.play()
            .then(() => alert('âœ… Ø§Ù„ØµÙˆØª ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯!'))
            .catch(error => alert('âŒ ÙØ´Ù„ ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª!\n\n' + error.message));
    } catch (e) {
        alert('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª: ' + e.message);
    }
};

// Utilities
const $ = (id) => document.getElementById(id);
const switchScreen = (screenId) => {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    $(screenId).classList.add('active');
};

const Modal = {
    show(icon, title, message) {
        $('modal-icon').textContent = icon;
        $('modal-title').textContent = title;
        $('modal-message').textContent = message;
        $('modal').classList.add('active');
    },
    hide() {
        $('modal').classList.remove('active');
    },
    success(message) {
        this.show('âœ…', 'Ù†Ø¬Ø§Ø­!', message);
    },
    error(message) {
        this.show('âŒ', 'Ø®Ø·Ø£!', message);
    },
    info(message) {
        this.show('â„¹ï¸', 'Ù…Ø¹Ù„ÙˆÙ…Ø©', message);
    }
};

// Socket Connection
const connectSocket = () => {
    socket = io(BACKEND_URL, {
        transports: ['websocket', 'polling']
    });

    socket.on('connect', () => {
        console.log('Connected:', socket.id);
        playSound('connected');
    });

    socket.on('roomCreated', (data) => {
        gameState.roomCode = data.code;
        $('room-code-display').textContent = data.code;
        switchScreen('waiting-room');
        updatePlayersList(data.players);
    });

    socket.on('roomUpdate', (players) => {
        updatePlayersList(players);
    });

    socket.on('gameStarted', (data) => {
        playSound('game_start');
        gameState.board = data.board;
        gameState.currentTurn = data.currentTurn;
        $('game-room-code').textContent = gameState.roomCode;
        switchScreen('game-screen');
        renderBoard();
        updateGameUI(data);
        Modal.success('Ø¨Ø¯Ø£Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! Ø­Ø¸Ø§Ù‹ Ù…ÙˆÙÙ‚Ø§Ù‹! ğŸ®');
    });

    socket.on('clueGiven', (data) => {
        gameState.clue = data.clue;
        gameState.guessesLeft = data.count + 1;
        $('current-clue').textContent = data.clue;
        $('clue-guesses').innerHTML = `Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªØ¨Ù‚ÙŠØ©: <strong>${data.count + 1}</strong>`;
        $('clue-section').classList.remove('hidden');
    });

    socket.on('cardRevealed', (data) => {
        const card = document.querySelector(`[data-index="${data.cardIndex}"]`);
        if (card) {
            card.classList.add('revealed', data.card.type);
        }
        
        switch (data.card.type) {
            case 'RED':
            case 'BLUE':
                playSound('correct');
                break;
            case 'INNOCENT':
                playSound('wrong');
                break;
            case 'ASSASSIN':
                playSound('assassin_hit');
                break;
        }
        updateScores();
        
        if (gameState.guessesLeft > 0) {
            gameState.guessesLeft--;
            $('clue-guesses').innerHTML = `Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªØ¨Ù‚ÙŠØ©: <strong>${gameState.guessesLeft}</strong>`;
        }
    });

    socket.on('gameUpdate', (data) => {
        if (data.guessesLeft !== undefined) {
            gameState.guessesLeft = data.guessesLeft;
            $('clue-guesses').innerHTML = `Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªØ¨Ù‚ÙŠØ©: <strong>${data.guessesLeft}</strong>`;
        }
        
        if (data.clue !== undefined) {
            gameState.clue = data.clue;
            $('current-clue').textContent = data.clue || 'ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªÙ„Ù…ÙŠØ­...';
        }
        
        updateGameUI(data);
    });

    socket.on('roomError', (msg) => Modal.error(msg));
    socket.on('gameError', (msg) => Modal.error(msg));
};

// HOME SCREEN
$('btn-enter-game').addEventListener('click', () => {
    const username = $('username-input').value.trim();
    if (!username) {
        Modal.error('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ');
        return;
    }
    gameState.username = username;
    $('player-name-display').textContent = username;
    switchScreen('lobby-screen');
    connectSocket();
});

// LOBBY SCREEN
$('btn-create-room').addEventListener('click', () => {
    const customName = $('create-room-name').value.toUpperCase().trim();
    socket.emit('createRoom', {
        customName,
        username: gameState.username
    });
});

$('btn-join-room').addEventListener('click', () => {
    const code = $('join-room-code').value.toUpperCase().trim();
    if (!code) {
        Modal.error('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©');
        return;
    }
    socket.emit('joinRoom', {
        roomCode: code,
        username: gameState.username
    });
    
    socket.once('roomUpdate', () => {
        gameState.roomCode = code;
        $('room-code-display').textContent = code;
        switchScreen('waiting-room');
    });
});

$('btn-back-home').addEventListener('click', () => {
    if (socket) socket.disconnect();
    switchScreen('home-screen');
});

// WAITING ROOM
document.querySelectorAll('.role-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        const team = btn.dataset.team;
        const role = btn.dataset.role;
        gameState.myTeam = team;
        gameState.myRole = role;
        socket.emit('setRole', { team, role });
    });
});

$('btn-start-game').addEventListener('click', () => {
    socket.emit('startGame');
});

$('btn-leave-room').addEventListener('click', () => {
    switchScreen('lobby-screen');
});

const updatePlayersList = (players) => {
    const list = $('players-list');
    $('players-count').textContent = players.length;
    
    list.innerHTML = players.map(p => {
        const teamIcon = p.team === 'RED' ? 'ğŸ”´' : p.team === 'BLUE' ? 'ğŸ”µ' : 'âšª';
        const roleIcon = p.role === 'SPYMASTER' ? ' ğŸ‘‘' : p.role === 'GUESSER' ? ' ğŸ¯' : '';
        return `<li class="player-item">${teamIcon} ${p.username}${roleIcon}</li>`;
    }).join('');
    
    const hasEnoughPlayers = players.filter(p => p.team && p.role).length >= 4;
    if (hasEnoughPlayers) {
        $('btn-start-game').classList.remove('hidden');
    } else {
        $('btn-start-game').classList.add('hidden');
    }
};

// GAME SCREEN
const renderBoard = () => {
    const board = $('game-board');
    board.innerHTML = '';
    
    gameState.board.forEach((card, index) => {
        const div = document.createElement('div');
        div.className = 'word-card';
        div.textContent = card.word;
        div.dataset.index = index;
        
        if (card.revealed) {
            div.classList.add('revealed', card.type);
        } else if (gameState.myRole === 'SPYMASTER') {
            const hintClass = {
                'RED': 'spy-hint-red',
                'BLUE': 'spy-hint-blue',
                'INNOCENT': 'spy-hint-beige',
                'ASSASSIN': 'spy-hint-black'
            };
            div.classList.add(hintClass[card.type]);
        }
        
        if (gameState.myRole === 'GUESSER' && !card.revealed) {
            div.addEventListener('click', () => {
                playSound('click');
                socket.emit('makeGuess', { cardIndex: index });
            });
        }
        
        board.appendChild(div);
    });
    
    updateControls();
};

const updateControls = () => {
    const spymaster = $('spymaster-controls');
    const guesser = $('guesser-controls');
    
    if (gameState.myRole === 'SPYMASTER') {
        spymaster.classList.remove('hidden');
        guesser.classList.add('hidden');
    } else if (gameState.myRole === 'GUESSER') {
        spymaster.classList.add('hidden');
        guesser.classList.remove('hidden');
    }
};

const updateGameUI = (data) => {
    if (data.currentTurn) {
        const turnText = data.currentTurn === 'RED' ? 
            'ğŸ”´ Ø¯ÙˆØ± Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±' : 'ğŸ”µ Ø¯ÙˆØ± Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚';
        $('status-message').textContent = turnText;
    }
    
    updateScores();
    
    if (data.winner) {
        playSound('win_game');
        const winnerText = data.winner === 'RED' ? 'Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø­Ù…Ø±' : 'Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ø²Ø±Ù‚';
        setTimeout(() => {
            Modal.show('ğŸ†', 'Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©!', `ÙØ§Ø² ${winnerText}! ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! ğŸ‰`);
        }, 500);
    }
};

const updateScores = () => {
    if (!gameState.board) return;
    
    let red = 0, blue = 0;
    gameState.board.forEach(card => {
        if (!card.revealed) {
            if (card.type === 'RED') red++;
            if (card.type === 'BLUE') blue++;
        }
    });
    
    $('red-score').textContent = red;
    $('blue-score').textContent = blue;
};

// Spymaster give clue
$('btn-give-clue').addEventListener('click', () => {
    const clue = $('clue-input').value.trim();
    const count = parseInt($('count-input').value);
    
    if (!clue || !count || count < 1 || count > 9) {
        Modal.error('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ØªÙ„Ù…ÙŠØ­ ÙˆØ¹Ø¯Ø¯ ØµØ­ÙŠØ­');
        return;
    }
    
    socket.emit('giveClue', { clue, count });
    $('clue-input').value = '';
    $('count-input').value = '';
});

// Guesser end turn
$('btn-end-turn').addEventListener('click', () => {
    playSound('door');
    socket.emit('endTurn');
});

// Modal
$('modal-confirm').addEventListener('click', () => Modal.hide());
$('modal').addEventListener('click', (e) => {
    if (e.target === $('modal')) Modal.hide();
});

// Join team buttons in game screen
document.querySelectorAll('.join-team-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        const team = btn.dataset.team;
        Modal.info('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¯ÙˆØ± Ù…Ù† ØºØ±ÙØ© Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±');
    });
});

// Wake up server
fetch(`${BACKEND_URL}/`).catch(() => {});

// Enter key shortcuts
$('username-input').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') $('btn-enter-game').click();
});

$('join-room-code').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') $('btn-join-room').click();
});

$('clue-input').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') $('btn-give-clue').click();
}
